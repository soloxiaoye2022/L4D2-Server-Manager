# L4D2 Server Manager (L4M)

一个强大、现代化的求生之路2 (Left 4 Dead 2) 服务器管理工具。
专为 Linux 环境设计，支持全平台（VPS、物理机、各类容器），提供流畅的 TUI 图形界面和 CLI 命令行操作。

## ✨ 核心特性

*   **🌐 多语言支持 (I18N)**: 首次运行自动选择语言（简体中文/English），并在 Root 环境下自动配置系统语言包，彻底告别乱码。
*   **🚀 一键安装 & 持久化**: 自动安装到系统，数据持久保存。默认安装路径统一为 `~/L4D2_Servers`，管理更方便。
*   **💻 强大的 CLI 工具**: 安装后直接使用 `l4m` 命令管理一切，支持自更新 (`l4m update`)。
*   **🖥️ 现代化 TUI 界面**: 全键盘操作的图形化菜单，支持实时流量监控、进度条下载反馈。
*   **📦 多实例管理**: 采用混合部署模式，核心二进制 (`bin`, `hl2`) 独立复制确保稳定，资源文件 (`maps`, `materials` 等) 软链共享节省空间。支持 **链接管理 (Link Manager)**，可随时在“共享模式”和“独立模式”间切换。
*   **🔌 智能插件管理**: 
    *   **全局插件库**: 默认共享 `~/L4D2_Plugins`，节省空间。
    *   **智能识别**: 自动识别并扁平化处理多层嵌套的插件包 (自动寻找 `JS-MODS`)。
    *   **安装跟踪**: 自动记录已装插件，避免重复操作。
    *   **一键平台**: 支持一键安装 SourceMod/MetaMod（优先使用本地预置包）。
*   **🛡️ 进程守护 & 自启**: 服务端崩溃自动重启；支持开机自启（Systemd/Crontab）。
*   **� 智能备份**: 一键备份服务端核心数据（含插件清单），自动排除日志等垃圾文件。
*   **📶 流量监控**: Root 用户可查看精准的端口级流量统计（实时速率/日/月报表）。

## 📥 快速开始

在终端中执行以下命令即可一键安装或运行：

```bash
bash <(curl -s -L https://gh-proxy.com/https://raw.githubusercontent.com/soloxiaoye2022/server_install/main/server_install/linux/init.sh)
```

脚本会自动检测您的环境并适配（支持 sudo 自动提权安装依赖）。

## 📖 使用指南

安装完成后，您可以在任意位置使用 `l4m` 命令：

```bash
l4m          # 打开主管理菜单 (TUI)
l4m update   # 更新管理器到最新版本
l4m install  # 重新运行安装向导 (修复安装)
```

### 主要功能模块

1.  **部署新服务器**: 
    - 交互式向导，支持 **匿名登录** (自动三步走修复下载问题) 和 **Steam 账号登录**。
    - 自动生成优化的 `server.cfg` 和启动脚本。

2.  **服务器管理**:
    - **启动/停止/重启**: 一键控制，实时反馈状态。
    - **链接管理 (Link Manager)**: 独创功能。允许对 `maps` (官方地图)、`materials`、`dlc` 等目录单独进行“软链/复制”切换。既能让所有服共享官方资源大幅节省空间，又能让某个服独立修改材质。
    - **集中式更新**: 也就是“更新服务端”功能。只需更新一次主缓存，所有处于“链接模式”的实例自动同步更新，维护百个服只需一键。
    - **流量统计**: 查看实时带宽使用情况。
    - **控制台 (Console)**: 直接进入服务端控制台 (tmux)，按 `Ctrl+B` 然后按 `D` 挂起。

3.  **插件管理**:
    - 自动扫描全局插件库。
    - 清晰标记已安装插件。
    - 支持自定义插件库路径。

## 🔧 高级说明

*   **进程管理**: 本工具使用 `tmux` 替代传统的 `screen`，提供更稳定的会话管理。
*   **容器兼容**: 针对 Docker、LXC 等容器环境进行了深度优化，自动解决 Locale 乱码问题。

## 🤝 贡献

欢迎提交 Issue 或 Pull Request 来帮助改进这个工具！
